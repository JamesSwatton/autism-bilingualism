<!DOCTYPE html>
<html>

<head>
  <title>Contact</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" href="./styles/style.css">
</head>

<body>
  <section>
    <div class="container media">
      <h1 class="media__heading">Contact</h1>
      <div class="media__text">
        <a href="mailto:hello@autism_bilingualism.com">hello@autism_bilingualism.com</a>
        <p>If you would like to help with additional translations or notice any revisions are needed, please do get in
          touch! We are a small team, but dedicated to improving and updating the site as much as we can.</p>

        <p>If you have time then please fill in the feedback form below, it will make a huge difference for future
          research and will only help us develop better ways of getting the information that matters to you in the best
          way possible. <strong>None of this information will be shared and is for research purposes only.</strong>
          Thank you.</p>
      </div>
      <img src="./assets/computer_flipped_2.png" class="media__img" />
    </div>
  </section>
  <section>
    <div class="container">
      <div class="form-wrapper">
        <h2>Feedback</h2>
        <form>
          <div class="field">
            <label for="name">Name</label>
            <input type="text" name="name" id="name">
          </div>

          <div class="field">
            <label for="email">Email</label>
            <input type="email" name="email" id="email" required>
          </div>

          <fieldset id="type">
            <legend>Are you a ...</legend>
            <div>
              <input type="radio" name="type" value="caregiver" id="caregiver" required>
              <label for="caregiver">Caregiver</label>
            </div>
            <div>
              <input type="radio" name="type" value="practitioner" id="practitioner">
              <label for="practitioner">Practitioner</label>
            </div>
            <div>
              <input type="radio" name="type" value="teacher" id="teacher">
              <label for="teacher">Teacher</label>
            </div>
            <div>
              <input type="radio" name="type" value="other" id="other">
              <label for="other">Other</label>
              <input type="text" name="other_detail" aria-label="other_detail_please_specify"
                placeholder="Please specify ..." id="other-detail" style="display: none">
            </div>
          </fieldset>

          <fieldset>
            <legend>How useful did you find this site?</legend>
            <div class="scale-wrapper">
              <div class="scale">
                <input type="radio" name="how_useful" value="not_at_all_useful" required>
                <label for="not_at_all_useful" class="emoji">☹️</label>
              </div>
              <div class="scale">
                <input type="radio" name="how_useful" value="slightly_useful">
                <label for="slightly_useful" class="emoji">🙁</label>
              </div>
              <div class="scale">
                <input type="radio" name="how_useful" value="somewhat_useful">
                <label for="somewhat_useful" class="emoji">😐</label>
              </div>
              <div class="scale">
                <input type="radio" name="how_useful" value="very_useful">
                <label for="very_useful" class="emoji">🙂</label>
              </div>
              <div class="scale">
                <input type="radio" name="how_useful" value="extremely_useful">
                <label for="extremely_useful" class="emoji">😀</label>
              </div>
            </div>
          </fieldset>

          <fieldset>
            <legend>How likely are you to recommend this site to parents?</legend>
            <div class="scale-wrapper">
              <div class="scale">
                <input type="radio" name="how_likely" value="not_at_all_likely" required>
                <label for="not_at_all_likely" class="emoji">☹️</label>
              </div>
              <div class="scale">
                <input type="radio" name="how_likely" value="slightly_likely">
                <label for="slightly_likely" class="emoji">🙁</label>
              </div>
              <div class="scale">
                <input type="radio" name="how_likely" value="somewhat_likely">
                <label for="somewhat_likely" class="emoji">😐</label>
              </div>
              <div class="scale">
                <input type="radio" name="how_likely" value="very_likely">
                <label for="very_likely" class="emoji">🙂</label>
              </div>
              <div class="scale">
                <input type="radio" name="how_likely" value="extremely_likely">
                <label for="extremely_likely" class="emoji">😀</label>
              </div>
            </div>
          </fieldset>

          <fieldset>
            <legend>Has this changed your opinion about autism and bilingualism?</legend>
            <div>
              <input type="radio" name="changed_opinion" value="yes" id="yes" required>
              <label for="yes">Yes</label>
            </div>
            <div>
              <input type="radio" name="changed_opinion" value="no" id="no">
              <label for="no">No</label>
              <input type="text" placeholder="Please tell us how ..." name="changed_opinion_detail">
            </div>
          </fieldset>

          <fieldset id="how-found-site">
            <legend>How did you come across this site?</legend>
            <div>
              <input type="radio" name="how_found_site" value="web_search" id="web-search" required>
              <label for="web_search">Web Search</label>
            </div>
            <div>
              <input type="radio" name="how_found_site" value="social_media" id="social-media">
              <label for="social_media">Social Media</label>
            </div>
            <div>
              <input type="radio" name="how_found_site" value="recommendation" id="recommendation">
              <label for="recommendation">Recommendation</label>
              <select name="recommendation_select" aria-label="recommendation_select" id="recommendation-select"
                style="display: none">
                <option value="">--Please choose an option--</option>
                <option value="teacher">Teacher</option>
                <option value="practitioner">Practitioner / Clinician</option>
                <option value="parent">Parent</option>
                <option value="other">Other</option>
              </select>
            </div>
          </fieldset>

          <label for="message">Is there anything else you'd like to tell us?</label>
          <textarea rows="4" name="message" id="message"></textarea>

          <button type="submit">Submit</button>
        </form>
      </div>
    </div>
  </section>

  <script>
    let url = 'https://test-site.pockethost.io/api/collections/forms/records';
    let form = document.querySelector('form');
    let type = document.querySelector('#type');
    let howFoundSite = document.querySelector('#how-found-site');
    let inputOtherDetail = document.querySelector('#other-detail');
    let recommendationSelect = document.querySelector('#recommendation-select');

    function showHideEl(el, e) {
      let prefix = el.id.split('-')[0];
      if (e.target.type == 'radio' && e.target.id !== prefix) {
        el.style = 'display: none';
      } else if (e.target.id == prefix) {
        el.style = 'display: block';
        if (el.type == 'text') el.value = '';
      }
    }

    function replacePairs(obj, pairs) {
      let arr = Object.keys(obj).map((key) => [String(key).replaceAll(pairs[0][0], pairs[0][1]), obj[key].replaceAll(pairs[0][0], pairs[1][1])])
      let newObj = Object.fromEntries(arr);
      return newObj;
    }

    type.addEventListener('click', (e) => {
      showHideEl(inputOtherDetail, e);
    })

    howFoundSite.addEventListener('click', (e) => {
      showHideEl(recommendationSelect, e);
    })

    form.addEventListener('submit', (e) => {
      e.preventDefault();
      let data = new FormData(form);
      fetch(url, {
        method: 'post',
        body: data
      }).then((res) => console.log(res))
    })

  </script>
</body>

</html>